<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>

<!-- Popper JS -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>

	<!-- Cart -->
	<div class="wrap-header-cart js-panel-cart">
		<div class="s-full js-hide-cart"></div>

		<div class="header-cart flex-col-l p-l-65 p-r-25">
			<div class="header-cart-title flex-w flex-sb-m p-b-8">
				<span class="mtext-103 cl2">
					Your Cart
				</span>

				<div class="fs-35 lh-10 cl2 p-lr-5 pointer hov-cl1 trans-04 js-hide-cart">
					<i class="zmdi zmdi-close"></i>
				</div>
			</div>
			
			<div class="header-cart-content flex-w js-pscroll">
				<ul class="header-cart-wrapitem w-full">
					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="images/item-cart-01.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								White Shirt Pleat
							</a>

							<span class="header-cart-item-info">
								1 x $19.00
							</span>
						</div>
					</li>

					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="images/item-cart-02.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								Converse All Star
							</a>

							<span class="header-cart-item-info">
								1 x $39.00
							</span>
						</div>
					</li>

					<li class="header-cart-item flex-w flex-t m-b-12">
						<div class="header-cart-item-img">
							<img src="images/item-cart-03.jpg" alt="IMG">
						</div>

						<div class="header-cart-item-txt p-t-8">
							<a href="#" class="header-cart-item-name m-b-18 hov-cl1 trans-04">
								Nixon Porter Leather
							</a>

							<span class="header-cart-item-info">
								1 x $17.00
							</span>
						</div>
					</li>
				</ul>
				
				<div class="w-full">
					<div class="header-cart-total w-full p-tb-40">
						Total: $75.00
					</div>

					<div class="header-cart-buttons flex-w w-full">
						<a href="shoping-cart.html" class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-r-8 m-b-10">
							View Cart
						</a>

						<a href="shoping-cart.html" class="flex-c-m stext-101 cl0 size-107 bg3 bor2 hov-btn3 p-lr-15 trans-04 m-b-10">
							Check Out
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- breadcrumb -->
	<div class="container">
		<div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
			<a href="index.html" class="stext-109 cl8 hov-cl1 trans-04">
				Home
				<i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
			</a>

			<span class="stext-109 cl4">
				Shoping Cart
			</span>
		</div>
	</div>
		

	<!-- Shoping Cart -->
	
		<div class="container">
			<div class="row">
				<div class="col-lg-10 col-xl-7 m-lr-auto m-b-50">
					<div class="m-l-25 m-r--38 m-lr-0-xl">
						<div class="wrap-table-shopping-cart">
							<table class="table-shopping-cart">
								<tr class="table_head">
									<th class="column-1">Product</th>
									<th class="column-2"></th>
									<th class="column-3">Price</th>
									<th class="column-4">Quantity</th>
									 <th class="column-5"></th>
									{{!-- <th class="column-6">Action</th> --}}
								</tr>
                                     {{#each products}}
								<tr class="table_row">
									
									<td class="column-1">
										<div class="how-itemcart1">

											<img src="/product-images/{{this.product._id}}.jpg" alt="IMG">
										</div>
									</td>
									<td class="column-2">{{this.product.Name}}</td>
                                   {{#ifCompare offer ''}}
									<td class="column-3">{{this.product.finalprice}}</td>
									{{else}}
									<td class="column-3">{{this.product.price}}</td>
									{{/ifCompare}}

									<td class="column-4">
										
										<button class="cart-item-count mr-3" onclick="changeQuantity('{{this._id}}','{{this.product._id}}','{{../user}}',-1)">-</button>
										<span id="{{this.product._id}}">{{this.quantity}}</span>
										<button class="cart-item-count ml-3" onclick="changeQuantity('{{this._id}}','{{this.product._id}}','{{../user}}',1)">+</button>
									</td>
								
									<td class="column-5">
										<div>
										<button class="btn btn-danger flex-c-m stext-101 cl2 size-40 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-3 mt-3  " style="margin-left: 36px;"  onclick="removeItem('{{this._id}}','{{this.product._id}}')">Remove</button>
										
										</div>
									
									</td>
								</tr>
                                {{/each}}
								
							</table>
						</div>
                          <form  method="post" action="/apply-coupon" id="apply-coupon">
						<div class="flex-w flex-sb-m bor15 p-t-18 p-b-15 p-lr-40 p-lr-15-sm">
							<div class="flex-w flex-m m-r-20 m-tb-5" style="margin-left: 70%;"> 
								
								
								<div class="flex-w flex-m m-r-20 m-tb-5">
									 {{#if CoupErr}} 
                                    <h5 class="text-danger" style="text-align:center ;">{{CoupErr}}</h5>
                                     {{/if}}
									
								<input class="stext-104 cl2 plh4 size-117 bor13 p-lr-20 m-r-10 m-tb-5" type="text" name="coupon" value="{{coupondata}}" style=" margin-left: -181%;">
								
								

								
								 <button class="btn bg8 hov-btn3 p-lr-15 trans-04 pointer m-tb-5" type="submit">Apply coupon</button>
						

                         </form>


								
	
                                 <button type="button" class="stext-50 cl2 size-50 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-5" data-toggle="modal" data-target="#exampleModal" style="margin-top: 49%; margin-left: -133%;">
                                   Available Coupons
                                  </button>
								</form>
                                  <!-- Modal -->
								  
                                  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" >
                                     <div class="modal-dialog" role="document">
                                      <div class="modal-content">
                                      <div class="modal-header">
		
                                       <h5 class="modal-title" id="exampleModalLabel">Available Coupons</h5>
                                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                       </button>
                                       </div>
	 
                                       <div class="modal-body" style="display: flex;flex-direction: row;">
										<form action="/couponcart" method="post">
		                              {{#each coupon}}
                                        <div class="card" style="width: 14rem; margin-bottom: 2%;margin-right: 2%;">
                                       <div class="card-body">
                                       
	                                  <div class="form-check" style="margin-left: 2%;">
										
                                     <input class="form-check-input" type="radio" name="coupon" value="{{this.CouponName}}"  id="gf{{@index}}">
 
                                      </div>
                                        <label for="gf{{@index}}">
                                       <h5 class="card-title">{{this.FName}}</h5>
                                       <h6 class="card-subtitle mb-2 text-muted">{{this.CouponName}}</h6>
                                       <p class="card-text">Offer amount : {{this.offer}}</p>
	                                      <p class="card-text">Offer Starting Date : {{this.sdate}}</p>
	                                            <p class="card-text">Offer Till: {{this.edate}}</p></label>
                                            
	
                                           </div>
                                           </div>
                                         {{/each}}
										
                                                    </div>
	                                
                                     <div class="modal-footer">
                                     <button type="button" class="btn btn-secondary" data-dismiss="modal" style="margin-top:3%;">Close</button>
		                               <button  type="submit" name="submit" class="btn btn-danger btn-md mt-3" value="submit" >select</button> 
                                                       
		                             
                                          </div>
										   </form>
                                      </div>
                                     </div>
                                      </div>
		
							        </div>	
									
                                       
								<div class="float-right pr-5">
									{{!-- {{#if offer_status}} --}}
									
									<h5 style="margin-top: -64%;">Total Price: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp<span id="tvalue">{{total}}</span></h5><br>
								
									 <h5> Amt Discnt: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp <span id="tvalue">{{discount}}</span></h5><br><hr> 
								    <h4>SubTotal Rs :&nbsp <span id="tvalue">{{final}}</span></h4>
								
								
								
									
									
									<h5>Coupon Dis :&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp  <span id="tvalue">{{coupondisamt}}</span></h5><hr>
                                  {{#if coupondisamt}}
                                     <h4>Total Rs :&nbsp&nbsp&nbsp&nbsp&nbsp <span id="tvalue">{{Cfinal}}</span></h4>
									{{/if}}

									
									<a href="/place-order" class="btn btn-success flex-c-m stext-101 cl2 size-118 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-5 mt-3"><b>Place Order</b></a>
									{{!-- {{/if}} --}}
								</div>
							</div>

						</div>
					</div>
				</div>

				
			</div>
		</div>
	{{!-- </form> --}}
	
	
		

	<!-- Footer -->
	<footer class="bg3 p-t-75 p-b-32">
		<div class="container">
			<div class="row">
				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						Categories
					</h4>

					<ul>
						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Women
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Men
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Shoes
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Watches
							</a>
						</li>
					</ul>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						Help
					</h4>

					<ul>
						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Track Order
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Returns 
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								Shipping
							</a>
						</li>

						<li class="p-b-10">
							<a href="#" class="stext-107 cl7 hov-cl1 trans-04">
								FAQs
							</a>
						</li>
					</ul>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						GET IN TOUCH
					</h4>

					<p class="stext-107 cl7 size-201">
						Any questions? Let us know in store at 8th floor, 379 Hudson St, New York, NY 10018 or call us on (+1) 96 716 6879
					</p>

					<div class="p-t-27">
						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-facebook"></i>
						</a>

						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-instagram"></i>
						</a>

						<a href="#" class="fs-18 cl7 hov-cl1 trans-04 m-r-16">
							<i class="fa fa-pinterest-p"></i>
						</a>
					</div>
				</div>

				<div class="col-sm-6 col-lg-3 p-b-50">
					<h4 class="stext-301 cl0 p-b-30">
						Newsletter
					</h4>

					<form>
						<div class="wrap-input1 w-full p-b-4">
							<input class="input1 bg-none plh1 stext-107 cl7" type="text" name="email" placeholder="email@example.com">
							<div class="focus-input1 trans-04"></div>
						</div>

						<div class="p-t-18">
							<button class="flex-c-m stext-101 cl0 size-103 bg1 bor1 hov-btn2 p-lr-15 trans-04">
								Subscribe
							</button>
						</div>
					</form>
				</div>
			</div>

			<div class="p-t-40">
				<div class="flex-c-m flex-w p-b-18">
					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-01.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-02.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-03.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-04.png" alt="ICON-PAY">
					</a>

					<a href="#" class="m-all-1">
						<img src="images/icons/icon-pay-05.png" alt="ICON-PAY">
					</a>
				</div>

				<p class="stext-107 cl6 txt-center">
					<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a> &amp; distributed by <a href="https://themewagon.com" target="_blank">ThemeWagon</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->

				</p>
			</div>
		</div>
	</footer>


	<!-- Back to top -->
	<div class="btn-back-to-top" id="myBtn">
		<span class="symbol-btn-back-to-top">
			<i class="zmdi zmdi-chevron-up"></i>
		</span>
	</div>

<!--===============================================================================================-->	
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
	<script>
		$(".js-select2").each(function(){
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});
		})
	</script>
<!--===============================================================================================-->
	<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
	<script>
		$('.js-pscroll').each(function(){
			$(this).css('position','relative');
			$(this).css('overflow','hidden');
			var ps = new PerfectScrollbar(this, {
				wheelSpeed: 1,
				scrollingThreshold: 1000,
				wheelPropagation: false,
			});

			$(window).on('resize', function(){
				ps.update();
			})
		});
	</script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>
	{{!-- <script src="sweetalert2.all.min.js"></script> --}}
<script>
	function changeQuantity(cartId,prodId,userId,count)
	{ 
		console.log(userId)
		let quantity=parseInt(document.getElementById(prodId).innerHTML)
		count=parseInt(count)
		console.log(count)
		$.ajax({

			
			url:'/change-product-quantity',
			
			data:{
				user:userId,
				cart:cartId,
			   product:prodId,
			   count:count,
			   quantity:quantity
			},
			method:'post',
			success:(response)=>{
				if(response.removeProduct){
					alert("Product Removed from cart")
					
					location.reload()
				}else{
					 //console.log('22222222222222222222222222..')
					 console.log(quantity+count)
					 //console.log('#####################')
					 console.log(response.total)
					document.getElementById(prodId).innerHTML=quantity+count
					document.getElementById('tvalue').innerHTML=response.total
                    
				}
			
			}
		})
	}
	function removeItem(cartId,prodId){
		$.ajax({
			url:'/remove-item',
			data:{
				cart:cartId,
				product:prodId
			},
			method:'post',
			success:(response)=>{
				if(response.removeProduct){
					location.reload()
					
					
				}
			}
		})
	}




  
  function removeCoupon(id) {
    $.ajax({
      url: '/admin/removeCoupon',
      data: {
        userid: id
      },
      method: 'post',
      success: (response) => {
        if (response.status) {
          Swal.fire({
            icon: 'success',
            title: 'Coupon is removed',
            confirmButtonText: 'ok',
          }).then((result) => {
            console.log(result)
            if (result.isConfirmed) {
              location.reload();
            }
          })
        }
      }
    })
  }
</script> 

</body>
</html>
<script>
	 $("#apply-coupon").submit((e)=>{
    console.log('ajax coupon');
    e.preventDefault()
    $.ajax({
        url:'/apply-coupon',
		 method:'post',
        data: $('#apply-coupon').serialize(),
        success:(response)=>{
          
				location.reload()
				
         

			}
        })
        
    })


 </script>